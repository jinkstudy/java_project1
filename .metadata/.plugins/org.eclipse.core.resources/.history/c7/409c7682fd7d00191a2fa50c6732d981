package model.dao;

import java.sql.*;
import java.util.ArrayList;

import model.StockDao;
import model.vo.Stock;


public class StockModel implements StockDao {
	String driver = "oracle.jdbc.driver.OracleDriver";
	String url ="jdbc:oracle:thin:@192.168.0.117:1521:orcl";
	String user = "jink";
	String pass = "1234";

	public StockModel() throws Exception {
		Class.forName(driver);
	}



	public String[] getMname() throws Exception {
		String[] mname=new String[9] ;

		Connection	con = null;
		PreparedStatement st= null;
		ResultSet rs =null;

		// 2. 찗써썂칲
		con = DriverManager.getConnection(url, user ,pass);
		//3. sql
		String sql = "SELECT  menuname FROM menu order by menuno";
		//4.첲쩉썂칲
		st = con.prepareStatement(sql);
		//5. 첲쩉
		rs = st.executeQuery();

		// 6. 써쎀칩쟕
		for (int i = 0; rs.next(); i++) {
			mname[i] = rs.getString("menuname");
			//System.out.println(mname[i]);
		}
		
		//7. 얳쐑
		rs.close();
		st.close();
		con.close();
		

		return mname;
	}



	@Override
	public int[] getStOrderCnt() throws Exception {
		// TODO Auto-generated method stub
		return null;
	}



	@Override
	public void insertSt(ArrayList<Stock> list) throws Exception {

		// 2. Connection 찗써썂칲 絶玲챰
				Connection con = DriverManager.getConnection(url, user ,pass);
				// 3. sql 졽천 쟞왤쐑
				String sql = "INSERT INTO stock(sno,sorderno,stime,menuno,scount) "
						+ " VALUES(sq_stock_sno.nextval,?,?,?,?) ";
//				String sql = "INSERT INTO stock(sno,menuno,scount) "
//						+ " VALUES(sq_stock_sno.nextval,?,1) ";
				//System.out.println(sql);
				// 4. sql 첲쩉썂칲 (PreparedStatement)	
				PreparedStatement st = con.prepareStatement(sql);
				
				//System.out.println(">"+vo[0]);

				for(Stock vo : list) {
					//System.out.println(vo[i].getsOrderNo());
					st.setString(1,vo.getsOrderNo());
					st.setString(2, vo.getsTime());
					st.setInt(3, vo.getMenuNo());
					st.setInt(4, vo.getsCount());
					 st.executeUpdate(); 
				}



				//6. 얳쐑
				st.close();
				con.close();

				
		
		
		
	}



	@Override
	public void updateSt(Stock vo) throws Exception {
		// TODO Auto-generated method stub
		
	}



	@Override
	public void deleteSt(String sOrderNo) throws Exception {
		
		
	}



	@Override
	public ArrayList getSearchList() throws Exception {
		// TODO Auto-generated method stub
		return null;
	}
	

}
